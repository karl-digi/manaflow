[Unit]
Description=Cmux memory safeguards (zram, swapfile, systemd limits)
DefaultDependencies=no
After=local-fs.target systemd-modules-load.service
Before=swap.target
ConditionPathExists=/usr/local/sbin/cmux-configure-memory

[Service]
Type=oneshot
Environment=CMUX_FORCE_SWAP=1
Environment=CMUX_SWAPFILE_SIZE_GIB=6
ExecStart=/usr/local/sbin/cmux-configure-memory
RemainAfterExit=yes

[Install]
WantedBy=multi-user.target
WantedBy=swap.target
